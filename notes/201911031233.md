---
date: 201911031233
lastmod: Wednesday, February 5, 2020 at 7:40:56 PM
tags: Linux, #linux, gunicorn, SSL, HTTPS, Ubuntu, #ubuntu, #gunicorn, #ssl, #https
---
# Let's Encrypt with Gunicorn

1. Install certbot[^8EA00D09337F]

```bash
sudo apt-get install software-properties-common
sudo add-apt-repository ppa:certbot/certbot
sudo apt-get update
sudo apt-get install certbot
```

There's a notification while adding repository which shows the repository is for Debian, and needs your confirmation before adding it. We can follow the link in the notification to check it supports certain version of Ubuntu or not.

2. generate keys by using dns challenging in manual mode. Gunicorn doesn't support accessing a local file from web by redirecting a certain URL, so http, in default, challenge doesn't work. We don't need to set the webroot since the key files are not automatically stored in it for the challenge later. Using the following command to generate keys.[^251203DD46CA]

```bash
sudo certbot certonly --manual  -d <domain name> --preferred-challenges dns
```


3. set up TXT recording for challenge. During last step, certbot requires a DNS TXT record to be set before moving on. Set the TXT record accordingly and check its availability manually[^EC719F813740].

```bash
dig -t txt <challenge domain>
```

4. copy generated pem files under `/etc/letsencrypt/live/<domain name> to start gunicorn with following parameters[^281CA2EBD72C]

```bash
--keyfile "privkey.pem" --certfile "cert.pem" --ca_certs "chain.pem"
```


[^251203DD46CA]: [[User Guide â€” Certbot 0.40.0.dev0 documentation]]

[^281CA2EBD72C]: [[ssl - Setup Gunicorn with let's encrypt cert - Stack Overflow]]

[^8EA00D09337F]: [[Running Your Flask Application Over HTTPS - miguelgrinberg.com]]

[^EC719F813740]: [[Linux command to inspect TXT records of a domain - Server Fault]]
